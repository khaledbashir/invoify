<p>INTEGRITY &amp; ALIGNMENT AUDIT: 7 CRITICAL VERIFICATION QUESTIONS</p>
<p>I&#39;ve performed a deep self-alignment audit of the ANC Studio build against Natalia&#39;s &#34;Master Truth&#34; requirements. Here are 7 High-Risk Alignment Questions that must be answered before implementing the multi-tab Excel verification viewer:</p>
<p>ðŸ”´ QUESTION 1: Divisor Margin Edge Case (CRITICAL)</p>
<p>File: lib/estimator.ts:428</p>
<p>Issue: No validation for desiredMargin &gt;= 1.0 (100%)</p>
<p>Risk: Division by zero returns Infinity</p>
<p>Recommendation: Add margin validation to prevent 100%+ margins</p>
<p>ðŸ”´ QUESTION 2: Tax Sequencing Clarification (HIGH PRIORITY)</p>
<p>File: lib/estimator.ts:629</p>
<p>Current: Tax applied at project level after per-screen calculations</p>
<div class="g3mark-callout g3mark-callout-question">
<span class="g3mark-callout__icon" aria-hidden="true"></span>
<p><span class="g3mark-callout__keyword">Question:</span> Should tax be calculated per-screen then summed, or summed then taxed?</p>
</div>
<p>Impact: Mathematically identical but affects accounting practices</p>
<p>ðŸ”´ QUESTION 3: Column Mapping Precision (HIGH PRIORITY)</p>
<p>File: services/proposal/server/excelImportService.ts:39</p>
<p>Issue: Fuzzy matching could mis-map columns (e.g., &#34;Pixel Pitch (mm)&#34; â†’ &#34;Pixel&#34;)</p>
<p>Risk: Incorrect data extraction from Excel</p>
<p>Recommendation: Use fixed column indices (A=0, E=4, F=5, G=6, H=7, J=9, M=12)</p>
<p>ðŸ”´ QUESTION 4: Alternate Row Detection Edge Cases (MEDIUM PRIORITY)</p>
<p>File: services/proposal/server/excelImportService.ts:71</p>
<p>Issue: &#34;ALTITUDE DISPLAY&#34; would be incorrectly skipped</p>
<p>Risk: Valid displays excluded from proposal</p>
<p>Recommendation: Use startsWith(&#39;ALT&#39;) instead of includes(&#39;alt&#39;)</p>
<p>ðŸ”´ QUESTION 5: 17/20 Blue Glow Metadata Tracking (HIGH PRIORITY)</p>
<p>File: lib/gap-analysis.ts:21</p>
<p>Gap: No filledByAI flag to track which fields were AI-filled vs manual</p>
<p>Risk: AI could overwrite manual corrections</p>
<p>Recommendation: Add metadata tracking with source, confidence, timestamp</p>
<p>ðŸ”´ QUESTION 6: RAG Keyword Weighting for Division 11 (MEDIUM PRIORITY)</p>
<p>File: lib/rag-sync.ts:48</p>
<div class="g3mark-callout g3mark-callout-question">
<span class="g3mark-callout__icon" aria-hidden="true"></span>
<p><span class="g3mark-callout__keyword">Question:</span> What are the top 5 weighted keywords for Section 11 06 60?</p>
</div>
<p>Expected: &#34;Section 11 06 60&#34;, &#34;Display Schedule&#34;, &#34;Division 11&#34;, &#34;LED Display&#34;, &#34;Pixel Pitch&#34;</p>
<p>Need: Verify scoreThreshold: 0.2 and topN: 6 are optimal for 2,500-page RFPs</p>
<p>ðŸ”´ QUESTION 7: Share Link Data Leakage Prevention (LOW PRIORITY)</p>
<p>File: app/api/projects/[id]/share/route.ts:84</p>
<p>Risk: console.log(project) before sanitization could leak internal costs to server logs</p>
<p>Recommendation: Deep clone before sanitization to prevent accidental logging</p>
<p>ðŸ“‹ CLARIFICATION QUESTIONS FOR AHMAD</p>
<p>Q1: Multi-Tab Excel Viewer Manual Overrides</p>
<p>Should the viewer allow inline editing with audit log, force re-upload for changes, or hybrid (temporary overrides only)?</p>
<p>Q2: Division 11 Conflict Resolution</p>
<p>If RAG finds conflict between &#34;Display Schedule&#34; and &#34;Technical Specs&#34;, which is master? Display Schedule (Section 11 06 60) or Technical Specs?</p>
<p>ðŸŽ¯ PRIORITY RECOMMENDATIONS</p>
<p>Immediate (Before Next Phase):</p>
<p>Fix 100% margin edge case (Question 1)</p>
<p>Clarify tax sequencing approach (Question 2)</p>
<p>Implement exact column mapping (Question 3)</p>
<p>High Priority:</p>
<ol start="4">
<li>Add filledByAI metadata tracking (Question 5)</li>
</ol>
<p>Medium Priority:</p>
<ol start="5">
<li>
<p>Verify RAG keyword weights (Question 6)</p>
</li>
<li>
<p>Enhance Alternate row detection (Question 4)</p>
</li>
</ol>
<p>Low Priority:</p>
<ol start="7">
<li>Implement deep cloning for share links (Question 7)</li>
</ol>
<p>Please provide guidance on these questions so I can implement the necessary fixes before proceeding with the multi-tab Excel verification viewer and site-specific structural logic.</p>
